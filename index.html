<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>PROTOTIPO</title>
<style>
html,body{
margin:0;
padding:0;
width:100%;
height:100%;
background:#000;
color:#fff;
font-family:monospace;
overflow:hidden
}
#ui{
position:absolute;
top:10px;
left:10px;
font-size:14px;
opacity:.8
}
#player{
width:20px;
height:20px;
background:#0f0;
position:absolute;
left:50%;
top:50%;
transform:translate(-50%,-50%)
}
.orb{
width:10px;
height:10px;
background:#fff;
border-radius:50%;
position:absolute
}
.warning{
color:red
}
</style>
</head>
<body>

<div id="ui">Muévete</div>
<div id="player"></div>

<script>
const player=document.getElementById("player")
const ui=document.getElementById("ui")

let px=window.innerWidth/2
let py=window.innerHeight/2
let speed=4
let score=0
let phase=0
let keys={}
let orbs=[]
let paranoia=0

document.addEventListener("keydown",e=>keys[e.key]=true)
document.addEventListener("keyup",e=>keys[e.key]=false)

function spawnOrb(){
let o=document.createElement("div")
o.className="orb"
o.style.left=Math.random()*window.innerWidth+"px"
o.style.top=Math.random()*window.innerHeight+"px"
document.body.appendChild(o)
orbs.push(o)
}

for(let i=0;i<5;i++)spawnOrb()

function collide(a,b){
let r1=a.getBoundingClientRect()
let r2=b.getBoundingClientRect()
return !(r1.right<r2.left||r1.left>r2.right||r1.bottom<r2.top||r1.top>r2.bottom)
}

function update(){
if(keys["w"])py-=speed
if(keys["s"])py+=speed
if(keys["a"])px-=speed
if(keys["d"])px+=speed

player.style.left=px+"px"
player.style.top=py+"px"

orbs.forEach((o,i)=>{
if(collide(player,o)){
o.remove()
orbs.splice(i,1)
score++
paranoia++
spawnOrb()
}
})

if(score>3&&phase===0){
ui.innerText="Sigue jugando"
phase=1
}

if(score>7&&phase===1){
ui.innerText="¿Por qué sigues?"
ui.classList.add("warning")
speed=6
phase=2
}

if(score>12&&phase===2){
ui.innerText=""
document.body.style.background="#050505"
phase=3
}

if(paranoia>20){
ui.innerText="Te está observando"
}

requestAnimationFrame(update)
}

update()

setInterval(()=>{
if(phase>=2){
orbs.forEach(o=>{
let dx=(px-o.offsetLeft)*0.01
let dy=(py-o.offsetTop)*0.01
o.style.left=o.offsetLeft+dx+"px"
o.style.top=o.offsetTop+dy+"px"
})
}
},30)
</script>

</body>
</html>
